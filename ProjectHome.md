implementing generic alorithm using scala idioms